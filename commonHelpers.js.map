{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport axios from 'axios';\n\n\n\n\nconst form = document.querySelector('.body-elements')\nconst imagesList = document.querySelector('.images-list');\n\nconst loader = document.querySelector('.loader')\n\nconst loadBtn = document.querySelector('.load-more-btn')\n\nconst BASE_URL = 'https://pixabay.com/api/'\nconst API_KEY = \"27271649-0bf2f3b05194a9267cfa0a660\"\n\nconst url = new URL(BASE_URL);\nurl.searchParams.append(\"key\", API_KEY)\nurl.searchParams.append('image_type', 'photo')\nurl.searchParams.append('orientation', 'horizontal')\nurl.searchParams.append('safesearch', 'true')\nurl.searchParams.append('per_page', '40')\n\n// const url = axios.create({\n//     baseURL: \"https://pixabay.com/api/\",\n//     params: {\n//         apiKey: \"27271649-0bf2f3b05194a9267cfa0a660\",\n//         image_type: \"photo\",\n//         orientation: \"horizontal\",\n//         safesearch: \"true\",\n//         per_page: \"40\"\n//     }\n// })\n\n\n\nloader.style.display = 'none';\nloadBtn.style.display = 'none';\nlet page = 1;\n\nconst scrollPage = () => {\n     const cardEl = document.querySelector('.card');\n                const cardRect = cardEl.getBoundingClientRect();\n                const cardHeight = cardRect.height;\n\n                window.scrollTo({\n                    top: window.scrollY + cardHeight * 2,\n                    behavior: 'smooth',\n                });\n}\n\nform.addEventListener('submit', async (event) => {\n    event.preventDefault();\n\n    page = 1;\n\n    loader.style.display = 'block';\n    \n    imagesList.innerHTML = '';\n\n    const query = event.currentTarget.elements.inputValue.value.trim();\n\n    if (query !== '') {\n        await renderImages(query); \n\n    } else {\n        iziToast.info({\n                    position: 'center',\n                    title: '',\n                    message: 'Please fill in the input field',\n        });\n        loader.style.display = 'none';\n        form.elements.inputValue.value = ''\n    }\n})\n\nloadBtn.addEventListener('click', async () => {\n        const query = form.elements.inputValue.value.trim();\n\n        await renderImages(query);\n\n        scrollPage()\n\n        });\n\n\n\nasync function getImage(quary, page) {\n\n    url.searchParams.set('q', quary);\n    url.searchParams.set('page', page);\n    \n\n    try {\n        const res = await axios.get(url);\n        \n        if (res.data.totalHits === 0) {\n            throw new Error\n        }\n        return res.data;\n        \n    } catch (error) {\n        throw error;\n    }\n    \n};\n\n\nasync function renderImages(quary) {\n    const per_page = url.searchParams.get('per_page');\n    let isLastPage = false;\n        \n    try {\n        const image = await getImage(quary, page);\n            \n             imagesList.insertAdjacentHTML(\"beforeend\", createImageHTML(image))\n\n        lightbox.refresh()\n        \n            page += 1\n\n\n        const lastPage = Math.ceil(image.totalHits / per_page);\n\n\n        if (lastPage < page || image.hits.length === 0) {\n            isLastPage = true;\n                iziToast.info({\n                        position: 'center',\n                        title: '',\n                    message: \"We're sorry, but you've reached the end of search results.\",});\n            loadBtn.style.display = 'none';\n            loader.style.display = 'none';\n            form.elements.inputValue.value = ''\n        } \n\n        if (isLastPage) {\n            loadBtn.style.display = 'none';\n            return []\n        }\n        loadBtn.style.display = 'block';\n        }\n        catch(error)  {\n        iziToast.error({\n                    position: 'center',\n                    title: '',\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n        });\n        loadBtn.style.display = 'none';\n        form.elements.inputValue.value = ''\n\n    } finally {\n        loader.style.display = 'none';\n    }    \n};\n\nfunction createImageHTML(image) {\n    const imagesHTML = image.hits.reduce((html, hit) => {\n        html += `\n            <div class=\"card gallery\">\n                    \n                <a class=\"large-img\" href=\"${hit.largeImageURL}\">\n                    <img width=\"300\" height=\"200\" alt=\"${hit.tags}\" src=\"${hit.webformatURL}\">\n                </a>\n\n                <div class=\"card-elems\">\n                    <div class=\"card-text-el\">\n                        <h2 class=\"card-title\">Likes</h2>\n                        <p class=\"card-text\">${hit.likes}</p>\n                    </div>\n                    <div class=\"card-text-el\">\n                        <h2 class=\"card-title\">Views</h2>\n                        <p class=\"card-text\">${hit.views}</p>\n                    </div>\n                    <div class=\"card-text-el\">\n                        <h2 class=\"card-title\">Comments</h2>\n                        <p class=\"card-text\">${hit.comments}</p>\n                    </div>\n                    <div class=\"card-text-el\">\n                        <h2 class=\"card-title\">Downloads</h2>\n                        <p class=\"card-text\">${hit.downloads}</p>\n                    </div>\n                </div>\n            </div>\n        `;\n        return html;\n    }, '');\n\n    return imagesHTML;\n};\n\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n        captionsData: \"alt\",\n        captionDelay: 250,\n        captionPosition:'bottom'\n    });\n\n"],"names":["form","imagesList","loader","loadBtn","BASE_URL","API_KEY","url","page","scrollPage","cardHeight","event","query","renderImages","iziToast","getImage","quary","res","axios","error","per_page","isLastPage","image","createImageHTML","lightbox","html","hit","SimpleLightbox"],"mappings":"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"}